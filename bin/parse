#!/usr/bin/env python3

import io
import os
import sys
import argparse

import wnix

METHODS = ('pypdf', 'pymupdf', 'pdfplumber', 'pypdfium2')

parser = argparse.ArgumentParser('parse')
parser.add_argument('path', nargs='?')
parser.add_argument('-m', '--method', choices=METHODS, default='pypdf')
args = parser.parse_args()

if args.path is not None:
    file = open(args.path, 'rb')
else:
    file = io.BytesIO(sys.stdin.buffer.read())

text = wnix.pdf_to_text(file, method=args.method)

# write to stdout
sys.stdout.write(text)
